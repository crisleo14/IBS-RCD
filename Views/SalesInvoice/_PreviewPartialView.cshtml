@using Accounting_System.Models.AccountsReceivable
@model SalesInvoice

@{
    ViewData["Title"] = "Sales Invoice";
}
<div class="modal fade" id="Preview-@Model.Id" data-bs-backdrop="static" aria-labelledby="PreviewSalesInvoiceLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="PreviewSalesInvoiceLabel">Preview</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <br />
                <div class="text-end">
                    <img src="~/img/Filpride.jpg" height="" width="130px" />
                </div>
                <div class="text-center">
                    <h2><u><b>&nbsp;FILPRIDE RESOURCES INC.&nbsp;</b></u></h2>
                    <p style="line-height: 1; margin-top:-7px;">
                        57 Westgate Office, Sampson Road, CBD, Subic Bay Freeport Zone,<br />
                        Kalaklan, Olongapo City, 2200 Zambales, Philippines<br />
                        VAT Reg. TIN: 000-216-589-00000
                    </p>

                    <h3><span style="display: inline-block;"><b>SALES INVOICE</b></span></h3>
                    <div class="text-end" style="margin-top:-60px;">
                        <h6><b>No.&nbsp;@Html.DisplayFor(model => model.SINo)</b></h6>
                    </div>

                </div>

                <div class="table-responsive text-start">
                    <table class="w-100" style="margin-top:20px;">
                        <tbody>
                            <tr>
                                <td>
                                    <span><b>Sold to:</b></span>
                                    &nbsp; @Html.DisplayFor(model => model.Customer.Name) &nbsp;<br />

                                    <span><b>Address:</b></span>
                                    &nbsp; @Html.DisplayFor(model => model.Customer.Address) &nbsp;<br />

                                    <span><b>TIN:</b></span>
                                    &nbsp; @Html.DisplayFor(model => model.Customer.TinNo) &nbsp;<br />

                                    <span><b>Business Style:</b></span>
                                    &nbsp; @Html.DisplayFor(model => model.Customer.BusinessStyle) &nbsp;
                                </td>

                                <td class="w-25 text-nowrap">

                                    <b>Invoice Date:</b>
                                    &nbsp; <span>@Model.TransactionDate.ToString("MM/dd/yyyy")</span>
                                    <br />
                                    <b>Terms:</b>&nbsp;<span>@Html.DisplayFor(model => model.Customer.Terms)</span>&nbsp;<br />
                                    <b>Due Date:</b>&nbsp; <span>@Model.DueDate.ToString("MM/dd/yyyy")</span><br />

                                    <b>Other Ref No.:</b>&nbsp; @Html.DisplayFor(model => model.OtherRefNo) &nbsp;
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-responsive" style="margin-top:20px;">
                    <table class="table-bordered w-100 text-center">
                        <tbody>
                            <tr>
                                <td><b>PRODUCT DESCRIPTION</b></td>
                                <td><b>UNIT</b></td>
                                <td><b>QUANTITY</b></td>
                                <td><b>UNIT PRICE</b></td>
                                <td><b>AMOUNT</b></td>
                            </tr>

                            <tr style="height:80px;">
                                <td>@Html.DisplayFor(model => model.Product.Name)</td>
                                <td>@Html.DisplayFor(model => model.Product.Unit)</td>
                                <td>@Model.Quantity.ToString("N0")</td>
                                <td>@Html.DisplayFor(model => model.UnitPrice)</td>
                                <td>@Html.DisplayFor(model => model.Amount)</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                @{
                    if (Model.Customer.CustomerType == "Vatable")
                    {
                        if (Model.Customer.WithHoldingTax && !Model.Customer.WithHoldingVat)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Tax with the amount of <b>@Html.DisplayFor(model => model.WithHoldingTaxAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2307 to your payment if you deducted Expanded Withholding Tax.
                            </p>
                        }
                        else if (Model.Customer.WithHoldingVat && !Model.Customer.WithHoldingTax)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Vat with the amount of <b>@Html.DisplayFor(model => model.WithHoldingVatAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2306 to your payment if you deducted Expanded Withholding Vat.
                            </p>
                        }
                        else if (Model.Customer.WithHoldingTax && Model.Customer.WithHoldingVat)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Tax with the amount of <b>@Html.DisplayFor(model => model.WithHoldingTaxAmount)</b> is computed for this invoice.<br />
                                Creditable Withholding Vat with the amount of <b>@Html.DisplayFor(model => model.WithHoldingVatAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2306 and 2307 to your payment if you deducted Expanded Withholding Tax and Vat.
                            </p>
                        }
                    }
                    else
                    {
                        if (Model.Customer.WithHoldingTax && !Model.Customer.WithHoldingVat)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Tax with the amount of <b>@Html.DisplayFor(model => model.WithHoldingTaxAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2307 to your payment if you deducted Expanded Withholding Tax.
                            </p>
                        }
                        else if (Model.Customer.WithHoldingVat && !Model.Customer.WithHoldingTax)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Vat with the amount of <b>@Html.DisplayFor(model => model.WithHoldingVatAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2306 to your payment if you deducted Expanded Withholding Vat.
                            </p>
                        }
                        else if (Model.Customer.WithHoldingTax && Model.Customer.WithHoldingVat)
                        {
                            <p class="text-start" style="line-height: 1; margin-top:20px;">
                                Creditable Withholding Tax with the amount of <b>@Html.DisplayFor(model => model.WithHoldingTaxAmount)</b> is computed for this invoice.<br />
                                Creditable Withholding Vat with the amount of <b>@Html.DisplayFor(model => model.WithHoldingVatAmount)</b> is computed for this invoice.<br />
                                Please attach BIR Form 2306 and 2307 to your payment if you deducted Expanded Withholding Tax and Vat.
                            </p>
                        }
                    }
                }
                    <table class="w-100" style="height:170px; margin-top:20px;">
                        <tbody>
                            <tr>
                                <td>

                                    <table class="table-bordered w-100 h-100" style="padding: 0; margin: 0;">
                                        <tbody>

                                            <tr class="h-100">
                                                <td style="position:relative; top:-85px; left:-12%;">INSTRUCTIONS: <br /><pre style="line-height: 1;">@Html.DisplayFor(model => model.Remarks)</pre></td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </td>
                                <td>
                                    <table class="table-bordered w-100 h-100" style="padding: 0; margin: 0;">
                                        <tbody>

                                            <tr class="align-text-top text-center text-nowrap">
                                                <td>
                                                    Prepared by
                                                    <br />
                                                    <p style="margin-top:20px;"><span style="display: inline-block; width:110px;" class="underline">@Html.DisplayFor(model => model.CreatedBy)</span></p>
                                                </td>
                                                <td>
                                                    Approved by
                                                    <br />
                                                    <p style="margin-top:20px;"><span style="display: inline-block; width:110px;" class="underline">Azh Adolfo</span></p>
                                                </td>

                                            </tr>
                                            <tr class="align-text-top">
                                                <td colspan="2">
                                                    <div style="margin-left:20px;">
                                                        HAULER/DRIVER
                                                        <span style="display: inline-block; width:90%;" class="underline"></span>
                                                    </div>
                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </td>
                                <td>
                                    <table class="table-bordered w-100 h-100" style="padding: 0; margin: 0;">
                                        <tbody class="text-nowrap table-font-bold">
                                            <tr style="padding-left: 8%;">
                                                <td><b>Vatable Sales: </b></td>

                                                <td class="text-end">
                                                    @if (Model.Customer.CustomerType == "Vatable")
                                                    {
                                                        @Html.DisplayFor(model => model.VatableSales)
                                                    }
                                                </td>

                                            </tr>
                                            <tr style="padding-left: 8%;">
                                                <td><b>Zero-Rated Sales: </b></td>

                                                <td class="text-end">
                                                    @if (Model.Customer.CustomerType == "Zero Rated")
                                                    {
                                                        @Html.DisplayFor(model => model.Amount)
                                                    }
                                                </td>
                                            </tr>
                                            <tr style="padding-left: 8%;">
                                                <td><b>VAT-Exempt Sales: </b></td>

                                                <td class="text-end">
                                                    @if (Model.Customer.CustomerType == "Exempt")
                                                    {
                                                        @Html.DisplayFor(model => model.Amount)
                                                    }
                                                </td>
                                            </tr>
                                            <tr style="padding-left: 8%;">
                                                <td><b>VAT Amount: </b></td>

                                                <td class="text-end">
                                                    @if (Model.Customer.CustomerType == "Vatable")
                                                    {
                                                        @Html.DisplayFor(model => model.VatAmount)
                                                    }
                                                </td>
                                            </tr>
                                            <tr style="padding-left: 8%;">
                                                <td><b>Discount: </b></td>

                                                <td class="text-end">
                                                    @if (Model.Discount != 0)
                                                    {
                                                        <p style="height: 9px;">@Html.DisplayFor(model => model.Discount)</p>
                                                    }
                                                </td>
                                            </tr>
                                            <tr style="padding-left: 8%;">
                                                <td><b>TOTAL SALES: </b></td>

                                                <td class="text-end">
                                                    @{
                                                        var totalSales = Model.VatableSales + Model.VatAmount;
                                                        var formattedTotalSales = String.Format("{0:N2}", totalSales);
                                                        var otherDiscount = Model.Amount - Model.Discount;
                                                        var formattedOtherDiscount = String.Format("{0:N2}", otherDiscount);
                                                    }
                                                    @if (Model.Discount == 0)
                                                    {
                                                        if (Model.Customer.CustomerType == "Vatable")
                                                        {
                                                            @Html.DisplayFor(model => formattedTotalSales)
                                                        }
                                                        else
                                                        {
                                                            @Model.Amount.ToString("N2")
                                                        }
                                                    }
                                                    else
                                                    {
                                                        @if (Model.Discount != 0)
                                                        {
                                                            @Html.DisplayFor(model => formattedOtherDiscount)
                                                        }
                                                    }
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                <div class="text-start" style="margin-top:20px;">
                    <p>
                        <i>This is a system generated invoice, no signature required.</i>
                    </p>
                </div>
                @if (Model.Customer.CustomerType == "Exempt")
                {
                    <div style="margin-top:20px;">
                        <p>
                            <em><strong>"THIS DOCUMENT IS NOT VALID FOR CLAIM OF INPUT TAX"</strong></em><br />
                        </p>
                    </div>
                }
                else if (Model.Customer.CustomerType == "Zero Rated")
                {
                    <div style="margin-top:20px;">
                        <p>
                            <em><strong>"THIS DOCUMENT IS NOT VALID FOR CLAIM OF INPUT TAX"</strong></em><br />
                        </p>
                    </div>
                }
                <br />
                <div class="text-center w-100" style="margin-top:20px;">
                    <p>
                        <span>Acknowledgement Certificate No:</span>
                        <span style="display: inline-block;">AC_124_112023_000090</span>
                        <span>&nbsp;&nbsp;Date Issued:</span>
                        <span style="display: inline-block;">November 28, 2023</span><br />
                        Series: SI0000000001 - SI9999999999
                    </p>
                </div>
                <br />
            </div>
        </div>
    </div>
</div>